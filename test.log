/home/korwin/PycharmProjects/finance-ml/venv/bin/python /home/korwin/PycharmProjects/finance-ml/ml_model/MNIST_model.py
Using TensorFlow backend.
train:
[66.66667  33.368607]
validation:
[65.840706 34.336285]
test:
[57.14286  44.897957]
x_train shape: (2835, 20, 20, 1)
2835 train samples
49 test samples

Train on 2835 samples, validate on 565 samples
Epoch 1/20
2019-03-17 13:24:03.181659: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-17 13:24:03.206423: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 1992000000 Hz
2019-03-17 13:24:03.206879: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x1fe6660 executing computations on platform Host. Devices:
2019-03-17 13:24:03.206921: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>

 200/2835 [=>............................] - ETA: 14s - loss: 0.9591 - acc: 0.5200
 400/2835 [===>..........................] - ETA: 8s - loss: 0.9532 - acc: 0.5200 
 600/2835 [=====>........................] - ETA: 6s - loss: 0.9680 - acc: 0.5033
 800/2835 [=======>......................] - ETA: 4s - loss: 0.9554 - acc: 0.5087
1000/2835 [=========>....................] - ETA: 4s - loss: 0.9445 - acc: 0.5160
1200/2835 [===========>..................] - ETA: 3s - loss: 2.6262 - acc: 0.5233
1400/2835 [=============>................] - ETA: 2s - loss: 2.3823 - acc: 0.5164
1600/2835 [===============>..............] - ETA: 2s - loss: 2.1905 - acc: 0.5194
1800/2835 [==================>...........] - ETA: 1s - loss: 2.0516 - acc: 0.5167
2000/2835 [====================>.........] - ETA: 1s - loss: 1.9305 - acc: 0.5170
2200/2835 [======================>.......] - ETA: 1s - loss: 1.8437 - acc: 0.5095
2400/2835 [========================>.....] - ETA: 0s - loss: 1.7658 - acc: 0.5087
2600/2835 [==========================>...] - ETA: 0s - loss: 1.7059 - acc: 0.5050
2800/2835 [============================>.] - ETA: 0s - loss: 1.6452 - acc: 0.5075
2835/2835 [==============================] - 5s 2ms/step - loss: 1.6351 - acc: 0.5076 - val_loss: 1.4109 - val_acc: 0.5504
Epoch 2/20

 200/2835 [=>............................] - ETA: 3s - loss: 11.9227 - acc: 0.4850
 400/2835 [===>..........................] - ETA: 3s - loss: 6.4071 - acc: 0.4975 
 600/2835 [=====>........................] - ETA: 3s - loss: 4.5841 - acc: 0.4917
 800/2835 [=======>......................] - ETA: 2s - loss: 3.6677 - acc: 0.4875
1000/2835 [=========>....................] - ETA: 2s - loss: 3.1225 - acc: 0.4880
1200/2835 [===========>..................] - ETA: 2s - loss: 2.7714 - acc: 0.4883
1400/2835 [=============>................] - ETA: 1s - loss: 2.5166 - acc: 0.4864
1600/2835 [===============>..............] - ETA: 1s - loss: 2.3178 - acc: 0.4912
1800/2835 [==================>...........] - ETA: 1s - loss: 2.1556 - acc: 0.4911
2000/2835 [====================>.........] - ETA: 1s - loss: 2.0314 - acc: 0.4900
2200/2835 [======================>.......] - ETA: 0s - loss: 1.9194 - acc: 0.4941
2400/2835 [========================>.....] - ETA: 0s - loss: 1.8330 - acc: 0.4983
2600/2835 [==========================>...] - ETA: 0s - loss: 1.7505 - acc: 0.5050
2800/2835 [============================>.] - ETA: 0s - loss: 1.6907 - acc: 0.5043
2835/2835 [==============================] - 4s 1ms/step - loss: 1.6781 - acc: 0.5048 - val_loss: 2.8611 - val_acc: 0.3434
Epoch 3/20

 200/2835 [=>............................] - ETA: 3s - loss: 12.2467 - acc: 0.5450
 400/2835 [===>..........................] - ETA: 3s - loss: 6.5351 - acc: 0.5375 
 600/2835 [=====>........................] - ETA: 3s - loss: 4.6222 - acc: 0.5383
 800/2835 [=======>......................] - ETA: 3s - loss: 3.6880 - acc: 0.5375
1000/2835 [=========>....................] - ETA: 2s - loss: 3.1135 - acc: 0.5440
1200/2835 [===========>..................] - ETA: 2s - loss: 2.7289 - acc: 0.5417
1400/2835 [=============>................] - ETA: 2s - loss: 2.4645 - acc: 0.5407
1600/2835 [===============>..............] - ETA: 1s - loss: 2.2595 - acc: 0.5456
1800/2835 [==================>...........] - ETA: 1s - loss: 2.1111 - acc: 0.5450
2000/2835 [====================>.........] - ETA: 1s - loss: 1.9844 - acc: 0.5430
2200/2835 [======================>.......] - ETA: 0s - loss: 1.8824 - acc: 0.5436
2400/2835 [========================>.....] - ETA: 0s - loss: 1.8066 - acc: 0.5396
2600/2835 [==========================>...] - ETA: 0s - loss: 1.7299 - acc: 0.5404
2800/2835 [============================>.] - ETA: 0s - loss: 1.6768 - acc: 0.5371
2835/2835 [==============================] - 4s 2ms/step - loss: 1.6679 - acc: 0.5379 - val_loss: 1.5850 - val_acc: 0.3699
Epoch 4/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.8320 - acc: 0.5750
 400/2835 [===>..........................] - ETA: 3s - loss: 0.8033 - acc: 0.5750
 600/2835 [=====>........................] - ETA: 2s - loss: 0.8092 - acc: 0.5483
 800/2835 [=======>......................] - ETA: 2s - loss: 0.8252 - acc: 0.5325
1000/2835 [=========>....................] - ETA: 2s - loss: 0.8268 - acc: 0.5320
1200/2835 [===========>..................] - ETA: 2s - loss: 0.8281 - acc: 0.5317
1400/2835 [=============>................] - ETA: 1s - loss: 0.8235 - acc: 0.5357
1600/2835 [===============>..............] - ETA: 1s - loss: 0.8216 - acc: 0.5344
1800/2835 [==================>...........] - ETA: 1s - loss: 0.8199 - acc: 0.5317
2000/2835 [====================>.........] - ETA: 1s - loss: 0.8187 - acc: 0.5300
2200/2835 [======================>.......] - ETA: 0s - loss: 0.8128 - acc: 0.5332
2400/2835 [========================>.....] - ETA: 0s - loss: 0.8164 - acc: 0.5337
2600/2835 [==========================>...] - ETA: 0s - loss: 1.6075 - acc: 0.5331
2800/2835 [============================>.] - ETA: 0s - loss: 1.5461 - acc: 0.5357
2835/2835 [==============================] - 4s 1ms/step - loss: 1.5380 - acc: 0.5358 - val_loss: 1.4343 - val_acc: 0.4602
Epoch 5/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.8116 - acc: 0.5500
 400/2835 [===>..........................] - ETA: 3s - loss: 0.7952 - acc: 0.5650
 600/2835 [=====>........................] - ETA: 2s - loss: 0.8004 - acc: 0.5600
 800/2835 [=======>......................] - ETA: 2s - loss: 4.7134 - acc: 0.5700
1000/2835 [=========>....................] - ETA: 2s - loss: 3.9237 - acc: 0.5710
1200/2835 [===========>..................] - ETA: 2s - loss: 3.3860 - acc: 0.5750
1400/2835 [=============>................] - ETA: 1s - loss: 3.0159 - acc: 0.5750
1600/2835 [===============>..............] - ETA: 1s - loss: 2.7372 - acc: 0.5763
1800/2835 [==================>...........] - ETA: 1s - loss: 2.5325 - acc: 0.5650
2000/2835 [====================>.........] - ETA: 1s - loss: 2.3556 - acc: 0.5655
2200/2835 [======================>.......] - ETA: 0s - loss: 2.2158 - acc: 0.5645
2400/2835 [========================>.....] - ETA: 0s - loss: 2.1003 - acc: 0.5658
2600/2835 [==========================>...] - ETA: 0s - loss: 1.9998 - acc: 0.5631
2800/2835 [============================>.] - ETA: 0s - loss: 1.9184 - acc: 0.5611
2835/2835 [==============================] - 4s 1ms/step - loss: 1.9073 - acc: 0.5594 - val_loss: 2.9851 - val_acc: 0.3434
Epoch 6/20

 200/2835 [=>............................] - ETA: 3s - loss: 10.1941 - acc: 0.5550
 400/2835 [===>..........................] - ETA: 3s - loss: 5.5558 - acc: 0.5250 
 600/2835 [=====>........................] - ETA: 2s - loss: 4.0149 - acc: 0.5267
 800/2835 [=======>......................] - ETA: 2s - loss: 3.2294 - acc: 0.5200
1000/2835 [=========>....................] - ETA: 2s - loss: 2.7583 - acc: 0.5260
1200/2835 [===========>..................] - ETA: 2s - loss: 2.4316 - acc: 0.5292
1400/2835 [=============>................] - ETA: 1s - loss: 2.1955 - acc: 0.5371
1600/2835 [===============>..............] - ETA: 1s - loss: 2.0320 - acc: 0.5350
1800/2835 [==================>...........] - ETA: 1s - loss: 1.8873 - acc: 0.5433
2000/2835 [====================>.........] - ETA: 1s - loss: 1.7757 - acc: 0.5450
2200/2835 [======================>.......] - ETA: 0s - loss: 1.6955 - acc: 0.5386
2400/2835 [========================>.....] - ETA: 0s - loss: 1.6220 - acc: 0.5379
2600/2835 [==========================>...] - ETA: 0s - loss: 1.5543 - acc: 0.5412
2800/2835 [============================>.] - ETA: 0s - loss: 1.5041 - acc: 0.5432
2835/2835 [==============================] - 4s 1ms/step - loss: 1.4937 - acc: 0.5443 - val_loss: 1.9362 - val_acc: 0.3434
Epoch 7/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.7674 - acc: 0.5650
 400/2835 [===>..........................] - ETA: 3s - loss: 0.8006 - acc: 0.5500
 600/2835 [=====>........................] - ETA: 2s - loss: 0.8148 - acc: 0.5467
 800/2835 [=======>......................] - ETA: 2s - loss: 0.8046 - acc: 0.5500
1000/2835 [=========>....................] - ETA: 2s - loss: 0.8146 - acc: 0.5570
1200/2835 [===========>..................] - ETA: 2s - loss: 0.8087 - acc: 0.5550
1400/2835 [=============>................] - ETA: 1s - loss: 0.8086 - acc: 0.5529
1600/2835 [===============>..............] - ETA: 1s - loss: 0.8033 - acc: 0.5531
1800/2835 [==================>...........] - ETA: 1s - loss: 0.8082 - acc: 0.5511
2000/2835 [====================>.........] - ETA: 1s - loss: 0.7987 - acc: 0.5615
2200/2835 [======================>.......] - ETA: 0s - loss: 0.8015 - acc: 0.5600
2400/2835 [========================>.....] - ETA: 0s - loss: 0.8001 - acc: 0.5571
2600/2835 [==========================>...] - ETA: 0s - loss: 0.7983 - acc: 0.5612
2800/2835 [============================>.] - ETA: 0s - loss: 1.5451 - acc: 0.5654
2835/2835 [==============================] - 4s 1ms/step - loss: 1.5340 - acc: 0.5661 - val_loss: 1.4843 - val_acc: 0.4124
Epoch 8/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.7267 - acc: 0.5950
 400/2835 [===>..........................] - ETA: 3s - loss: 0.7794 - acc: 0.5875
 600/2835 [=====>........................] - ETA: 2s - loss: 0.7774 - acc: 0.5700
 800/2835 [=======>......................] - ETA: 2s - loss: 0.7862 - acc: 0.5725
1000/2835 [=========>....................] - ETA: 2s - loss: 0.8040 - acc: 0.5570
1200/2835 [===========>..................] - ETA: 2s - loss: 0.8143 - acc: 0.5492
1400/2835 [=============>................] - ETA: 1s - loss: 0.8262 - acc: 0.5436
1600/2835 [===============>..............] - ETA: 1s - loss: 0.8262 - acc: 0.5469
1800/2835 [==================>...........] - ETA: 1s - loss: 0.8208 - acc: 0.5478
2000/2835 [====================>.........] - ETA: 1s - loss: 0.8138 - acc: 0.5510
2200/2835 [======================>.......] - ETA: 0s - loss: 0.8043 - acc: 0.5545
2400/2835 [========================>.....] - ETA: 0s - loss: 0.8117 - acc: 0.5521
2600/2835 [==========================>...] - ETA: 0s - loss: 1.7048 - acc: 0.5481
2800/2835 [============================>.] - ETA: 0s - loss: 1.6410 - acc: 0.5482
2835/2835 [==============================] - 4s 1ms/step - loss: 1.6310 - acc: 0.5481 - val_loss: 1.3341 - val_acc: 0.5788
Epoch 9/20

 200/2835 [=>............................] - ETA: 4s - loss: 0.7963 - acc: 0.5800
 400/2835 [===>..........................] - ETA: 3s - loss: 0.7744 - acc: 0.5750
 600/2835 [=====>........................] - ETA: 3s - loss: 0.7694 - acc: 0.5750
 800/2835 [=======>......................] - ETA: 2s - loss: 0.7653 - acc: 0.5800
1000/2835 [=========>....................] - ETA: 2s - loss: 3.5441 - acc: 0.5860
1200/2835 [===========>..................] - ETA: 2s - loss: 3.0798 - acc: 0.5833
1400/2835 [=============>................] - ETA: 2s - loss: 2.7563 - acc: 0.5843
1600/2835 [===============>..............] - ETA: 1s - loss: 2.5229 - acc: 0.5769
1800/2835 [==================>...........] - ETA: 1s - loss: 2.3425 - acc: 0.5678
2000/2835 [====================>.........] - ETA: 1s - loss: 2.1958 - acc: 0.5625
2200/2835 [======================>.......] - ETA: 0s - loss: 2.0755 - acc: 0.5659
2400/2835 [========================>.....] - ETA: 0s - loss: 1.9750 - acc: 0.5671
2600/2835 [==========================>...] - ETA: 0s - loss: 1.8906 - acc: 0.5642
2800/2835 [============================>.] - ETA: 0s - loss: 1.8113 - acc: 0.5657
2835/2835 [==============================] - 4s 1ms/step - loss: 1.8008 - acc: 0.5654 - val_loss: 1.8783 - val_acc: 0.4389
Epoch 10/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.7872 - acc: 0.6150
 400/2835 [===>..........................] - ETA: 3s - loss: 0.7909 - acc: 0.6100
 600/2835 [=====>........................] - ETA: 3s - loss: 0.7985 - acc: 0.6100
 800/2835 [=======>......................] - ETA: 2s - loss: 0.8197 - acc: 0.6013
1000/2835 [=========>....................] - ETA: 2s - loss: 3.9649 - acc: 0.5950
1200/2835 [===========>..................] - ETA: 2s - loss: 3.4310 - acc: 0.6025
1400/2835 [=============>................] - ETA: 2s - loss: 3.0610 - acc: 0.5993
1600/2835 [===============>..............] - ETA: 1s - loss: 2.7980 - acc: 0.5881
1800/2835 [==================>...........] - ETA: 1s - loss: 2.5754 - acc: 0.5850
2000/2835 [====================>.........] - ETA: 1s - loss: 2.4006 - acc: 0.5820
2200/2835 [======================>.......] - ETA: 0s - loss: 2.2641 - acc: 0.5764
2400/2835 [========================>.....] - ETA: 0s - loss: 2.1384 - acc: 0.5783
2600/2835 [==========================>...] - ETA: 0s - loss: 2.0308 - acc: 0.5788
2800/2835 [============================>.] - ETA: 0s - loss: 1.9386 - acc: 0.5814
2835/2835 [==============================] - 4s 1ms/step - loss: 1.9243 - acc: 0.5827 - val_loss: 1.4461 - val_acc: 0.5717
Epoch 11/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.8620 - acc: 0.5700
 400/2835 [===>..........................] - ETA: 3s - loss: 0.8184 - acc: 0.5650
 600/2835 [=====>........................] - ETA: 2s - loss: 0.8046 - acc: 0.5583
 800/2835 [=======>......................] - ETA: 2s - loss: 0.7862 - acc: 0.5775
1000/2835 [=========>....................] - ETA: 2s - loss: 0.7892 - acc: 0.5770
1200/2835 [===========>..................] - ETA: 2s - loss: 0.7953 - acc: 0.5758
1400/2835 [=============>................] - ETA: 1s - loss: 2.4265 - acc: 0.5771
1600/2835 [===============>..............] - ETA: 1s - loss: 2.2173 - acc: 0.5756
1800/2835 [==================>...........] - ETA: 1s - loss: 2.0534 - acc: 0.5783
2000/2835 [====================>.........] - ETA: 1s - loss: 1.9144 - acc: 0.5855
2200/2835 [======================>.......] - ETA: 0s - loss: 1.8105 - acc: 0.5777
2400/2835 [========================>.....] - ETA: 0s - loss: 1.7176 - acc: 0.5817
2600/2835 [==========================>...] - ETA: 0s - loss: 1.6403 - acc: 0.5854
2800/2835 [============================>.] - ETA: 0s - loss: 1.5778 - acc: 0.5871
2835/2835 [==============================] - 4s 1ms/step - loss: 1.5673 - acc: 0.5869 - val_loss: 1.3240 - val_acc: 0.6566
Epoch 12/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.7327 - acc: 0.5900
 400/2835 [===>..........................] - ETA: 3s - loss: 5.2864 - acc: 0.5700
 600/2835 [=====>........................] - ETA: 2s - loss: 3.7916 - acc: 0.5650
 800/2835 [=======>......................] - ETA: 2s - loss: 3.0527 - acc: 0.5525
1000/2835 [=========>....................] - ETA: 2s - loss: 2.5894 - acc: 0.5600
1200/2835 [===========>..................] - ETA: 2s - loss: 2.2706 - acc: 0.5625
1400/2835 [=============>................] - ETA: 1s - loss: 2.0612 - acc: 0.5600
1600/2835 [===============>..............] - ETA: 1s - loss: 1.8932 - acc: 0.5656
1800/2835 [==================>...........] - ETA: 1s - loss: 1.7629 - acc: 0.5672
2000/2835 [====================>.........] - ETA: 1s - loss: 1.6589 - acc: 0.5725
2200/2835 [======================>.......] - ETA: 0s - loss: 1.5743 - acc: 0.5759
2400/2835 [========================>.....] - ETA: 0s - loss: 1.5016 - acc: 0.5787
2600/2835 [==========================>...] - ETA: 0s - loss: 1.4390 - acc: 0.5804
2800/2835 [============================>.] - ETA: 0s - loss: 1.3878 - acc: 0.5793
2835/2835 [==============================] - 4s 1ms/step - loss: 1.3815 - acc: 0.5774 - val_loss: 1.3115 - val_acc: 0.6743
Epoch 13/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.7139 - acc: 0.6200
 400/2835 [===>..........................] - ETA: 3s - loss: 0.7730 - acc: 0.5675
 600/2835 [=====>........................] - ETA: 2s - loss: 0.7592 - acc: 0.5717
 800/2835 [=======>......................] - ETA: 2s - loss: 0.7450 - acc: 0.5800
1000/2835 [=========>....................] - ETA: 2s - loss: 0.7447 - acc: 0.5770
1200/2835 [===========>..................] - ETA: 2s - loss: 0.7444 - acc: 0.5692
1400/2835 [=============>................] - ETA: 1s - loss: 0.7429 - acc: 0.5700
1600/2835 [===============>..............] - ETA: 1s - loss: 0.7342 - acc: 0.5762
1800/2835 [==================>...........] - ETA: 1s - loss: 1.8203 - acc: 0.5806
2000/2835 [====================>.........] - ETA: 1s - loss: 1.7122 - acc: 0.5805
2200/2835 [======================>.......] - ETA: 0s - loss: 1.6253 - acc: 0.5782
2400/2835 [========================>.....] - ETA: 0s - loss: 1.5469 - acc: 0.5775
2600/2835 [==========================>...] - ETA: 0s - loss: 1.4846 - acc: 0.5815
2800/2835 [============================>.] - ETA: 0s - loss: 1.4284 - acc: 0.5804
2835/2835 [==============================] - 4s 1ms/step - loss: 1.4198 - acc: 0.5788 - val_loss: 1.3558 - val_acc: 0.5381
Epoch 14/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.7170 - acc: 0.5950
 400/2835 [===>..........................] - ETA: 3s - loss: 0.7345 - acc: 0.5775
 600/2835 [=====>........................] - ETA: 2s - loss: 4.8521 - acc: 0.5850
 800/2835 [=======>......................] - ETA: 2s - loss: 3.8150 - acc: 0.6000
1000/2835 [=========>....................] - ETA: 2s - loss: 3.1925 - acc: 0.5980
1200/2835 [===========>..................] - ETA: 2s - loss: 2.7729 - acc: 0.6042
1400/2835 [=============>................] - ETA: 1s - loss: 2.4801 - acc: 0.6079
1600/2835 [===============>..............] - ETA: 1s - loss: 2.2634 - acc: 0.6037
1800/2835 [==================>...........] - ETA: 1s - loss: 2.0851 - acc: 0.6072
2000/2835 [====================>.........] - ETA: 1s - loss: 1.9496 - acc: 0.6085
2200/2835 [======================>.......] - ETA: 0s - loss: 1.8375 - acc: 0.6055
2400/2835 [========================>.....] - ETA: 0s - loss: 1.7486 - acc: 0.6033
2600/2835 [==========================>...] - ETA: 0s - loss: 1.6721 - acc: 0.6027
2800/2835 [============================>.] - ETA: 0s - loss: 1.6061 - acc: 0.6025
2835/2835 [==============================] - 4s 1ms/step - loss: 1.5950 - acc: 0.6025 - val_loss: 1.7488 - val_acc: 0.3735
Epoch 15/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.7281 - acc: 0.6200
 400/2835 [===>..........................] - ETA: 3s - loss: 0.7035 - acc: 0.6325
 600/2835 [=====>........................] - ETA: 2s - loss: 0.7112 - acc: 0.6233
 800/2835 [=======>......................] - ETA: 2s - loss: 0.7224 - acc: 0.6163
1000/2835 [=========>....................] - ETA: 2s - loss: 0.7207 - acc: 0.6120
1200/2835 [===========>..................] - ETA: 2s - loss: 0.7246 - acc: 0.6067
1400/2835 [=============>................] - ETA: 1s - loss: 0.7308 - acc: 0.6000
1600/2835 [===============>..............] - ETA: 1s - loss: 0.7256 - acc: 0.6100
1800/2835 [==================>...........] - ETA: 1s - loss: 2.0179 - acc: 0.6056
2000/2835 [====================>.........] - ETA: 1s - loss: 1.8897 - acc: 0.6050
2200/2835 [======================>.......] - ETA: 0s - loss: 1.7816 - acc: 0.6064
2400/2835 [========================>.....] - ETA: 0s - loss: 1.6892 - acc: 0.6092
2600/2835 [==========================>...] - ETA: 0s - loss: 1.6185 - acc: 0.6046
2800/2835 [============================>.] - ETA: 0s - loss: 1.5531 - acc: 0.6050
2835/2835 [==============================] - 4s 1ms/step - loss: 1.5420 - acc: 0.6060 - val_loss: 1.3766 - val_acc: 0.4814
Epoch 16/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.6380 - acc: 0.6550
 400/2835 [===>..........................] - ETA: 3s - loss: 0.6414 - acc: 0.6625
 600/2835 [=====>........................] - ETA: 2s - loss: 0.6636 - acc: 0.6433
 800/2835 [=======>......................] - ETA: 2s - loss: 0.6617 - acc: 0.6450
1000/2835 [=========>....................] - ETA: 2s - loss: 0.6852 - acc: 0.6300
1200/2835 [===========>..................] - ETA: 2s - loss: 0.6910 - acc: 0.6233
1400/2835 [=============>................] - ETA: 1s - loss: 0.6869 - acc: 0.6250
1600/2835 [===============>..............] - ETA: 1s - loss: 0.6970 - acc: 0.6181
1800/2835 [==================>...........] - ETA: 1s - loss: 0.6919 - acc: 0.6189
2000/2835 [====================>.........] - ETA: 1s - loss: 1.6250 - acc: 0.6185
2200/2835 [======================>.......] - ETA: 0s - loss: 1.5398 - acc: 0.6214
2400/2835 [========================>.....] - ETA: 0s - loss: 1.4690 - acc: 0.6217
2600/2835 [==========================>...] - ETA: 0s - loss: 1.4116 - acc: 0.6204
2800/2835 [============================>.] - ETA: 0s - loss: 1.3643 - acc: 0.6171
2835/2835 [==============================] - 4s 1ms/step - loss: 1.3566 - acc: 0.6173 - val_loss: 1.3268 - val_acc: 0.5982
Epoch 17/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.6835 - acc: 0.6500
 400/2835 [===>..........................] - ETA: 3s - loss: 0.6783 - acc: 0.6375
 600/2835 [=====>........................] - ETA: 2s - loss: 0.6857 - acc: 0.6367
 800/2835 [=======>......................] - ETA: 2s - loss: 3.0374 - acc: 0.6275
1000/2835 [=========>....................] - ETA: 2s - loss: 2.5682 - acc: 0.6280
1200/2835 [===========>..................] - ETA: 2s - loss: 2.2607 - acc: 0.6192
1400/2835 [=============>................] - ETA: 1s - loss: 2.0492 - acc: 0.6129
1600/2835 [===============>..............] - ETA: 1s - loss: 1.8819 - acc: 0.6106
1800/2835 [==================>...........] - ETA: 1s - loss: 1.7470 - acc: 0.6117
2000/2835 [====================>.........] - ETA: 1s - loss: 1.6392 - acc: 0.6150
2200/2835 [======================>.......] - ETA: 0s - loss: 1.5588 - acc: 0.6114
2400/2835 [========================>.....] - ETA: 0s - loss: 1.4916 - acc: 0.6067
2600/2835 [==========================>...] - ETA: 0s - loss: 1.4304 - acc: 0.6100
2800/2835 [============================>.] - ETA: 0s - loss: 1.3738 - acc: 0.6143
2835/2835 [==============================] - 4s 1ms/step - loss: 1.3660 - acc: 0.6141 - val_loss: 1.3493 - val_acc: 0.5664
Epoch 18/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.6959 - acc: 0.6150
 400/2835 [===>..........................] - ETA: 3s - loss: 0.7022 - acc: 0.5975
 600/2835 [=====>........................] - ETA: 2s - loss: 0.6910 - acc: 0.6117
 800/2835 [=======>......................] - ETA: 2s - loss: 0.6954 - acc: 0.6075
1000/2835 [=========>....................] - ETA: 2s - loss: 0.6923 - acc: 0.6110
1200/2835 [===========>..................] - ETA: 2s - loss: 2.7085 - acc: 0.6167
1400/2835 [=============>................] - ETA: 1s - loss: 2.4177 - acc: 0.6186
1600/2835 [===============>..............] - ETA: 1s - loss: 2.2010 - acc: 0.6169
1800/2835 [==================>...........] - ETA: 1s - loss: 2.0318 - acc: 0.6189
2000/2835 [====================>.........] - ETA: 1s - loss: 1.8923 - acc: 0.6250
2200/2835 [======================>.......] - ETA: 0s - loss: 1.7769 - acc: 0.6305
2400/2835 [========================>.....] - ETA: 0s - loss: 1.6880 - acc: 0.6275
2600/2835 [==========================>...] - ETA: 0s - loss: 1.6146 - acc: 0.6215
2800/2835 [============================>.] - ETA: 0s - loss: 1.5451 - acc: 0.6236
2835/2835 [==============================] - 4s 1ms/step - loss: 1.5338 - acc: 0.6243 - val_loss: 1.2976 - val_acc: 0.6566
Epoch 19/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.6595 - acc: 0.6450
 400/2835 [===>..........................] - ETA: 3s - loss: 0.6748 - acc: 0.6325
 600/2835 [=====>........................] - ETA: 2s - loss: 0.6753 - acc: 0.6300
 800/2835 [=======>......................] - ETA: 2s - loss: 0.6800 - acc: 0.6262
1000/2835 [=========>....................] - ETA: 2s - loss: 0.6850 - acc: 0.6180
1200/2835 [===========>..................] - ETA: 2s - loss: 0.6892 - acc: 0.6167
1400/2835 [=============>................] - ETA: 1s - loss: 0.6917 - acc: 0.6086
1600/2835 [===============>..............] - ETA: 1s - loss: 0.6900 - acc: 0.6106
1800/2835 [==================>...........] - ETA: 1s - loss: 0.6880 - acc: 0.6128
2000/2835 [====================>.........] - ETA: 1s - loss: 0.6887 - acc: 0.6150
2200/2835 [======================>.......] - ETA: 0s - loss: 0.6887 - acc: 0.6182
2400/2835 [========================>.....] - ETA: 0s - loss: 0.6883 - acc: 0.6183
2600/2835 [==========================>...] - ETA: 0s - loss: 0.6893 - acc: 0.6142
2800/2835 [============================>.] - ETA: 0s - loss: 0.6846 - acc: 0.6193
2835/2835 [==============================] - 4s 1ms/step - loss: 1.3804 - acc: 0.6187 - val_loss: 1.2879 - val_acc: 0.6566
Epoch 20/20

 200/2835 [=>............................] - ETA: 3s - loss: 0.6813 - acc: 0.6000
 400/2835 [===>..........................] - ETA: 3s - loss: 0.7071 - acc: 0.5875
 600/2835 [=====>........................] - ETA: 3s - loss: 3.8248 - acc: 0.5983
 800/2835 [=======>......................] - ETA: 3s - loss: 3.0592 - acc: 0.5825
1000/2835 [=========>....................] - ETA: 3s - loss: 2.6089 - acc: 0.5730
1200/2835 [===========>..................] - ETA: 2s - loss: 2.3045 - acc: 0.5692
1400/2835 [=============>................] - ETA: 2s - loss: 2.0804 - acc: 0.5743
1600/2835 [===============>..............] - ETA: 2s - loss: 1.9261 - acc: 0.5688
1800/2835 [==================>...........] - ETA: 1s - loss: 1.7957 - acc: 0.5678
2000/2835 [====================>.........] - ETA: 1s - loss: 1.7005 - acc: 0.5640
2200/2835 [======================>.......] - ETA: 1s - loss: 1.6144 - acc: 0.5664
2400/2835 [========================>.....] - ETA: 0s - loss: 1.5413 - acc: 0.5683
2600/2835 [==========================>...] - ETA: 0s - loss: 1.4826 - acc: 0.5704
2800/2835 [============================>.] - ETA: 0s - loss: 1.4365 - acc: 0.5661
2835/2835 [==============================] - 5s 2ms/step - loss: 1.4310 - acc: 0.5654 - val_loss: 1.4783 - val_acc: 0.6425
[75.51020408 24.48979592]

32/49 [==================>...........] - ETA: 0s
49/49 [==============================] - 0s 381us/step
Точность работы на тестовых данных: 59.18%